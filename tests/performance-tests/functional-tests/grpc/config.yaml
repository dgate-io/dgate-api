version: v1
log_level: debug

storage:
  type: memory

proxy:
  port: ${DGATE_PORT:-8080}
  host: 0.0.0.0
  
  init_resources:
    namespaces:
      - name: "test"
    
    services:
      - name: "grpc-upstream"
        namespace: "test"
        urls:
          - "http://127.0.0.1:${TEST_SERVER_PORT:-50051}"
        http2_only: true  # gRPC requires HTTP/2
    
    routes:
      - name: "grpc-route"
        paths: ["/**"]  # gRPC uses paths like /helloworld.Greeter/SayHello
        methods: ["POST"]  # gRPC uses POST
        namespace: "test"
        service: "grpc-upstream"
    
    domains:
      - name: "default-domain"
        namespace: "test"
        patterns: ["*"]

admin:
  port: ${DGATE_ADMIN_PORT:-9080}
  host: 0.0.0.0
