version: v1
log_level: debug

storage:
  type: memory

proxy:
  port: ${DGATE_PORT:-8080}
  host: 0.0.0.0
  
  init_resources:
    namespaces:
      - name: "test"
    
    services:
      - name: "h2-upstream"
        namespace: "test"
        urls:
          - "http://127.0.0.1:${TEST_SERVER_PORT:-19999}"
        http2_only: false  # Allow both HTTP/1.1 and HTTP/2
    
    routes:
      - name: "h2-route"
        paths: ["/h2/**"]
        methods: ["GET", "POST"]
        namespace: "test"
        service: "h2-upstream"
        strip_path: true
    
    domains:
      - name: "default-domain"
        namespace: "test"
        patterns: ["*"]  # Match all hosts

admin:
  port: ${DGATE_ADMIN_PORT:-9080}
  host: 0.0.0.0
